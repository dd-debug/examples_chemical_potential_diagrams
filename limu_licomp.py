'''
Created on May 13, 2021

@author: jiadongc
'''
import matplotlib.pyplot as plt
from pymatgen.core.composition import Composition
from adjustText import adjust_text
colors = {'Li3Al2': [0.517933, 0.021563, 0.654109, 1.0], 'LiAl(Si2O5)2': [0.940015, 0.975158, 0.131326, 1.0], 'LiAl3': [0.920714, 0.458417, 0.336166, 1.0], 'Li21Si5': [0.140603, 0.021687, 0.566959, 1.0], 'ClO3': [1.0, 0.36777954425013254, 0.0, 1.0], 'LiO8': [0.98119, 0.848329, 0.142279, 1.0], 'Li': [0.050383, 0.029803, 0.527975, 1.0], 'AlCl3': [1.0, 0.7705352411234765, 0.0, 1.0], 'Al': [1.0, 0.918918918918919, 0.0, 1.0], 'LiCl': [0.573632, 0.060028, 0.637349, 1.0], 'Li2O2': [0.625987, 0.103312, 0.611305, 1.0], 'LiAl': [0.674522, 0.147419, 0.578688, 1.0], 'LiAl5O8': [0.961681, 0.914672, 0.15052, 1.0], 'Li13Si4': [0.21435, 0.016973, 0.599239, 1.0], 'ClO2': [0.27556968733439324, 1.0, 0.0, 1.0], 'Li2Al': [0.343925, 0.004991, 0.64471, 1.0], 'Li4Al3Si3ClO12': [0.979233, 0.607532, 0.238013, 1.0], 'LiAlSi': [0.830018, 0.320172, 0.437836, 1.0], 'LiSi': [0.719181, 0.191729, 0.542663, 1.0], 'Cl2': [0.0, 1.0, 0.40059034366434765, 1.0], 'AlClO': [0.0, 1.0, 0.5481762597512125, 1.0], 'Li2SiO3': [0.862927, 0.365119, 0.403519, 1.0], 'Al2SiO5': [0.0, 1.0, 0.8011806873286953, 1.0], 'Li3AlSiO5': [0.89325, 0.411048, 0.369768, 1.0], 'Li12Si7': [0.46555, 0.004545, 0.660139, 1.0], 'Al2O3': [0.0, 0.774722932651321, 1.0, 1.0], 'LiAlO2': [0.944844, 0.507658, 0.302433, 1.0], 'Li4SiO4': [0.798216, 0.280197, 0.469538, 1.0], 'LiAlCl4': [0.989935, 0.663787, 0.204859, 1.0], 'Cl2O7': [0.0, 0.24190110826939448, 1.0, 1.0], 'Li7Si3': [0.280648, 0.011488, 0.625038, 1.0], 'O2': [0.035166240409207294, 0.0, 1.0, 1.0], 'Si': [0.16304347826086973, 0.0, 1.0, 1.0], 'Li2O': [0.405503, 0.000678, 0.656977, 1.0], 'LiClO4': [0.994474, 0.722691, 0.174381, 1.0], 'SiCl4': [0.5893009377664112, 0.0, 1.0, 1.0], 'Li2Si2O5': [0.965024, 0.559118, 0.268513, 1.0], 'LiAlSiO4': [0.991897, 0.784239, 0.151042, 1.0], 'SiO2': [0.9942455242966756, 0.0, 1.0, 1.0], 'Cl2O': [1.0, 0.0, 0.8778772378516622, 1.0], 'Li5AlO4': [0.760264, 0.235976, 0.505794, 1.0]}
centers = {'Li3Al2': [-0.1477220486111086, -8.192505390565758, -7.744861675613598], 'LiAl(Si2O5)2': [-2.774077765223763, -5.568404831030336, -2.317063685679013], 'LiAl3': [-0.37358774261904854, -7.4968638374808965, -8.185836647374455], 'Li21Si5': [-0.07197957764757813, -7.445657033036101, -8.151391398015557], 'ClO3': [-7.817395203233627, -1.4898546438850078, -0.16919038812499793], 'LiO8': [-3.4926266198128637, -7.742988722528104, -0.028854396690058376], 'Li': [-3.1720657846433045e-16, -7.683945206143679, -8.30573917245595], 'AlCl3': [-6.359003769381431, -1.3263012571318422, -6.952584523594106], 'Al': [-3.568069670170345, -5.77268243333375, -7.27850672093188], 'LiCl': [-2.1722027441170577, -2.082331507476276, -4.625973564542972], 'Li2O2': [-3.090424697000001, -6.678333589091008, -0.21113577633333278], 'LiAl': [-0.2799567853273795, -7.544769912507471, -8.23870812392584], 'LiAl5O8': [-2.838027707394028, -5.045147511244919, -2.1782375624290133], 'Li13Si4': [-0.15210234137586856, -7.371173508913432, -8.354119243364186], 'ClO2': [-6.581416300419405, -0.5902473332579325, -0.5468170718760329], 'Li2Al': [-0.021996016642856425, -7.671256844459316, -7.939709254995021], 'Li4Al3Si3ClO12': [-2.665821629283085, -1.6387253255639138, -2.436786623917486], 'LiAlSi': [-0.40939937231685003, -7.4786311691535206, -8.246722309459248], 'LiSi': [-0.39237391270833255, -6.9695901220734475, -7.645602929197942], 'Cl2': [-7.495260915931004, -2.3684757858670006e-16, -5.823469859839175], 'AlClO': [-6.821256079150582, -1.6441524922183341, -3.8032145771354173], 'Li2SiO3': [-2.634064667979457, -5.652852244857751, -2.0198086477216446], 'Al2SiO5': [-5.905170708129279, -3.183232194817754, -1.7621397803497156], 'Li3AlSiO5': [-2.3730326657999306, -4.944578220425145, -2.3605680066937857], 'Li12Si7': [-0.38045965201712195, -7.303136416409778, -7.429357520377069], 'Al2O3': [-6.074358054676647, -3.3141845093538773, -1.9927618239907403], 'LiAlO2': [-1.418534024026219, -6.339060050405155, -4.015251012950077], 'Li4SiO4': [-1.810507994132199, -6.055256867752405, -2.923087882342894], 'LiAlCl4': [-3.0187106700419166, -1.3455046542180835, -5.797463775372188], 'Cl2O7': [-7.90118606962524, -1.9663802520100089, -0.012418222499996912], 'Li7Si3': [-0.2814659665640129, -6.743917019681732, -7.5701564021831835], 'O2': [-5.9424968745189855, -6.259369464843785, -3.552713678800501e-16], 'Si': [-2.6159665689066616, -6.020923079249694, -6.352645285610546], 'Li2O': [-1.1863859047628833, -6.385185357179193, -3.8273119321409], 'LiClO4': [-3.8054452707594253, -1.8453194570256506, -0.26329403657706507], 'SiCl4': [-6.257935233968053, -0.9603458544501197, -5.78827177528846], 'Li2Si2O5': [-2.5557446935037893, -4.981243942928196, -2.405004644709596], 'LiAlSiO4': [-2.7809919694832357, -6.187159577479039, -2.020375581469352], 'SiO2': [-6.018220424423253, -3.7734489395761877, -2.034018569634288], 'Cl2O': [-7.321186721868119, -0.12916196083734902, -0.9359126773453031], 'Li5AlO4': [-1.6095861755697642, -6.385397344297861, -3.0981227134163682]}
cls=[]
ces = []
coms = []
txts = []
for i in colors:
    elss = [str(elll) for elll in Composition(i).elements]
    if "Li" in elss:
        cls.append(colors[i])
        ces.append(centers[i][0])
        coms.append(Composition(i).get_atomic_fraction("Li"))
        txts.append(plt.text(Composition(i).get_atomic_fraction("Li"),centers[i][0],i,fontsize=8,c=colors[i]))

plt.scatter(coms,ces,color=cls)

adjust_text(txts)
font2 = {'family' : 'Calibri',
    'weight' : 'normal',
    'size'   : 16,}
plt.xlabel('Li atomic fraction',font2)
plt.ylabel('Li polytope average mu',font2)
ax=plt.gca()
ax.spines['bottom'].set_linewidth(2)
ax.spines['left'].set_linewidth(2)
ax.spines['right'].set_linewidth(2)
ax.spines['top'].set_linewidth(2)
plt.show()
